(()=>{var e={};e.id=8954,e.ids=[8954],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},98466:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var r=t(67096),l=t(16132),s=t(37284),n=t.n(s),o=t(32564),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);t.d(a,i);let d=["",{children:["dashboard",{children:["talking-head",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,72663)),"/Users/theodorosiakovou/Projects/ai-platform/src/app/dashboard/talking-head/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,92551)),"/Users/theodorosiakovou/Projects/ai-platform/src/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,79113)),"/Users/theodorosiakovou/Projects/ai-platform/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/theodorosiakovou/Projects/ai-platform/src/app/dashboard/talking-head/page.tsx"],u="/dashboard/talking-head/page",x={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/dashboard/talking-head/page",pathname:"/dashboard/talking-head",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},46010:(e,a,t)=>{Promise.resolve().then(t.bind(t,61811))},61811:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>TalkingHeadPage});var r=t(30784),l=t(9885);let s="web-client",n=[{value:"full",label:"Full"},{value:"crop",label:"Crop"},{value:"resize",label:"Resize"},{value:"none",label:"None"}],o=[{value:"",label:"None"},{value:"gfpgan",label:"GFPGAN"},{value:"RestoreFormer",label:"RestoreFormer"}],i=[{value:"",label:"None"},{value:"realesrgan",label:"Real-ESRGAN"},{value:"gpen",label:"GPEN"}],d=[{value:"512p",label:"512p (High Quality)"},{value:"256p",label:"256p (Faster)"}];function UploadTalkingHead(){let[e,a]=(0,l.useState)(null),[t,c]=(0,l.useState)(null),[u,x]=(0,l.useState)("full"),[m,g]=(0,l.useState)("512p"),[p,b]=(0,l.useState)(""),[h,f]=(0,l.useState)(""),[v,y]=(0,l.useState)(1),[j,N]=(0,l.useState)(0),[w,k]=(0,l.useState)(2),[S,_]=(0,l.useState)(!1),[P,C]=(0,l.useState)(""),[I,G]=(0,l.useState)(""),[E,M]=(0,l.useState)(""),[U,q]=(0,l.useState)(null),[R,T]=(0,l.useState)(null),[A,H]=(0,l.useState)(null),[$,F]=(0,l.useState)(void 0),[D,J]=(0,l.useState)(null),[B,z]=(0,l.useState)(null),[L,O]=(0,l.useState)(null),[V,W]=(0,l.useState)(!1),[Z,Q]=(0,l.useState)([]),[X,Y]=(0,l.useState)(!1),[K,ee]=(0,l.useState)("create"),ea=(0,l.useRef)(null),et=(0,l.useCallback)(async()=>{try{Y(!0);let e=await fetch(`/api/sadtalker/history?userId=${encodeURIComponent(s)}`,{method:"GET",cache:"no-store"});if(!e.ok)throw Error(`History request failed (${e.status})`);let a=await e.json();Q(Array.isArray(a.items)?a.items:[])}catch(e){console.warn("[sadtalker-ui] history error",e)}finally{Y(!1)}},[]),er=(0,l.useMemo)(()=>!!e&&!!t&&!V,[e,t,V]);(0,l.useEffect)(()=>{if(!U)return;ea.current&&clearInterval(ea.current);let poll=async()=>{try{let e=await fetch(`/api/sadtalker/status?id=${encodeURIComponent(U)}`,{method:"GET",cache:"no-store"});if(!e.ok)throw Error(`Status request failed (${e.status})`);let a=await e.json();T(a.state??null),H(a.remoteState??null),"number"==typeof a.progress&&F(a.progress);let t="succeeded"===a.state||"completed"===a.state;t&&a.result?.videoUrl?(J(a.result.videoUrl),z(new Date().toISOString()),ea.current&&clearInterval(ea.current)):"failed"===a.state&&(O(a.error?.message||"SadTalker job failed"),ea.current&&clearInterval(ea.current))}catch(e){console.warn("[sadtalker-ui] polling error",e)}};return poll(),ea.current=setInterval(poll,3e3),()=>{ea.current&&clearInterval(ea.current)}},[U]),(0,l.useEffect)(()=>{et()},[et]),(0,l.useEffect)(()=>{D&&et()},[D,et]);let renderHistory=()=>(0,r.jsxs)("section",{className:"bg-gray-900/40 border border-gray-800 rounded-2xl p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"History"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-50",children:"Recent talking heads"}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Stored per user ID (",s,")."]})]}),r.jsx("button",{type:"button",onClick:()=>et(),className:"inline-flex items-center justify-center rounded-full border border-gray-700 px-4 py-1.5 text-xs font-semibold text-gray-200 hover:border-blue-400 hover:text-blue-300",children:"Refresh"})]}),X&&r.jsx("div",{className:"text-sm text-gray-400",children:"Loading your previous renders…"}),!X&&0===Z.length&&r.jsx("div",{className:"text-sm text-gray-400",children:"No talking head videos saved yet. Generate one above to populate this list."}),!X&&Z.length>0&&r.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Z.map(e=>{let a=e.createdAt?new Date(e.createdAt).toLocaleString():"—",t=e.remoteJobId?`#${e.remoteJobId.slice(-6)}`:`Job ${e.jobId}`;return(0,r.jsxs)("article",{className:"rounded-xl border border-gray-800 bg-gray-950/80 p-3 space-y-3",children:[r.jsx("div",{className:"rounded-lg overflow-hidden bg-black aspect-video",children:r.jsx("video",{src:e.videoUrl,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0,preload:"metadata",controls:!0})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:t}),r.jsx("p",{className:"text-sm text-gray-300",children:a})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2 text-sm",children:[r.jsx("a",{href:e.videoUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"Open"}),r.jsx("a",{href:e.videoUrl,download:!0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 rounded-full bg-blue-600 px-3 py-1 text-xs font-semibold text-white hover:bg-blue-500",children:"Download"})]})]},`${e.jobId}-${e.remoteJobId||"local"}`)})})]});async function handleSubmit(a){if(a.preventDefault(),O(null),J(null),z(null),T(null),F(void 0),H(null),!e){O("Please choose a source image (PNG/JPG).");return}if(!t){O("Please choose an audio file (MP3/WAV).");return}W(!0);try{let a=new FormData;a.append("source_image",e),a.append("driven_audio",t),a.append("preprocess",u),a.append("resolution",m),a.append("expression_scale",v.toString()),a.append("pose_style",j.toString()),a.append("batch_size",w.toString()),a.append("still",S?"true":"false"),p&&a.append("enhancer",p),h&&a.append("background_enhancer",h),P.trim()&&a.append("input_yaw",P.trim()),I.trim()&&a.append("input_pitch",I.trim()),E.trim()&&a.append("input_roll",E.trim()),a.append("userId",s);let r=await fetch("/api/sadtalker/create",{method:"POST",body:a}),l=await r.json();if(!r.ok)throw Error(l?.error||"Failed to enqueue SadTalker job");q(l.jobId),T("queued")}catch(e){O(e?.message||"Failed to start SadTalker job")}finally{W(!1)}}return(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex gap-2",children:[{label:"Generate",value:"create"},{label:"My videos",value:"history"}].map(e=>r.jsx("button",{type:"button",onClick:()=>ee(e.value),className:`rounded-full px-4 py-1.5 text-sm font-semibold transition ${K===e.value?"bg-blue-600 text-white shadow-lg shadow-blue-600/30":"bg-gray-800/70 text-gray-300 hover:text-white"}`,children:e.label},e.value))}),"create"===K&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"Source Image (PNG/JPG)"}),r.jsx("input",{type:"file",accept:"image/png,image/jpeg",onChange:e=>a(e.target.files?.[0]??null),className:"block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-500"}),r.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Max 10 MB. Use a clear frontal face for best results."})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"Driven Audio (MP3/WAV)"}),r.jsx("input",{type:"file",accept:"audio/mpeg,audio/wav",onChange:e=>c(e.target.files?.[0]??null),className:"block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-500"}),r.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Max 15 MB. Audio will drive lip sync."})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"Preprocess"}),r.jsx("select",{value:u,onChange:e=>x(e.target.value),className:"w-full bg-gray-900 text-gray-100 rounded-md p-3 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:n.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"Resolution"}),r.jsx("select",{value:m,onChange:e=>g(e.target.value),className:"w-full bg-gray-900 text-gray-100 rounded-md p-3 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:d.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"Face Enhancer"}),r.jsx("select",{value:p,onChange:e=>b(e.target.value),className:"w-full bg-gray-900 text-gray-100 rounded-md p-3 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:o.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"Background Enhancer"}),r.jsx("select",{value:h,onChange:e=>f(e.target.value),className:"w-full bg-gray-900 text-gray-100 rounded-md p-3 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:i.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Expression Scale"}),r.jsx("input",{type:"range",min:.5,max:1.5,step:.05,value:v,onChange:e=>y(Number(e.target.value)),className:"w-full"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:v.toFixed(2)})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Pose Style"}),r.jsx("input",{type:"number",min:-10,max:10,value:j,onChange:e=>N(Number(e.target.value)),className:"w-full bg-gray-900 text-gray-100 rounded-md p-3 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Batch Size"}),r.jsx("input",{type:"number",min:1,max:8,value:w,onChange:e=>k(Number(e.target.value)),className:"w-full bg-gray-900 text-gray-100 rounded-md p-3 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600"})]})]}),r.jsx("div",{className:"col-span-1 md:col-span-2",children:(0,r.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-300",children:[r.jsx("input",{type:"checkbox",checked:S,onChange:e=>_(e.target.checked),className:"h-4 w-4"}),"Use still-mode (keeps head movements minimal)"]})}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Input Yaw (comma separated)"}),r.jsx("input",{type:"text",value:P,onChange:e=>C(e.target.value),placeholder:"e.g. -10,0,10",className:"w-full bg-gray-900 text-gray-100 rounded-md p-3 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Input Pitch (comma separated)"}),r.jsx("input",{type:"text",value:I,onChange:e=>G(e.target.value),placeholder:"e.g. -3,0,3",className:"w-full bg-gray-900 text-gray-100 rounded-md p-3 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Input Roll (comma separated)"}),r.jsx("input",{type:"text",value:E,onChange:e=>M(e.target.value),placeholder:"e.g. -2,0,2",className:"w-full bg-gray-900 text-gray-100 rounded-md p-3 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600"})]})]}),r.jsx("button",{type:"submit",disabled:!er,className:`w-full md:w-auto px-6 py-3 rounded-md font-semibold transition ${er?"bg-blue-600 hover:bg-blue-500":"bg-gray-700 cursor-not-allowed"}`,children:V?"Submitting…":"Generate Talking Head"})]}),U&&(0,r.jsxs)("div",{className:"bg-gray-800/80 border border-gray-700 rounded-lg p-4 space-y-2",children:[r.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Job"}),r.jsx("div",{className:"text-sm text-gray-300 break-all",children:U}),(0,r.jsxs)("div",{className:"space-y-1 text-sm text-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Status"}),r.jsx("span",{className:"font-semibold text-blue-400",children:R??"queued"})]}),A&&(0,r.jsxs)("div",{className:"text-xs uppercase tracking-wide text-gray-500",children:["Current step: ",r.jsx("span",{className:"text-gray-300",children:A})]})]}),"number"==typeof $&&(0,r.jsxs)("div",{children:[r.jsx("div",{className:"w-full bg-gray-900/70 rounded-full h-2 overflow-hidden",children:r.jsx("div",{className:"bg-blue-500 h-2 transition-all",style:{width:`${Math.max(5,Math.min(100,$))}%`}})}),(0,r.jsxs)("div",{className:"mt-1 text-xs text-gray-400",children:[$.toFixed(0),"% complete"]})]})]}),L&&r.jsx("div",{className:"bg-red-900/40 border border-red-700 text-red-200 rounded-lg p-4 text-sm",children:L}),D&&"create"===K&&(0,r.jsxs)("section",{className:"bg-gray-900/80 border border-gray-800 rounded-2xl p-6 space-y-5 shadow-2xl shadow-black/40",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Result ready"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-50",children:"Talking head generated successfully"}),B&&(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:["Ready ",new Date(B).toLocaleString(void 0,{hour12:!1})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsxs)("a",{href:D,download:!0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 rounded-full bg-blue-600 px-5 py-2 text-sm font-semibold text-white transition hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 focus:ring-offset-gray-900",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"h-5 w-5",children:[r.jsx("path",{d:"M12 3a1 1 0 0 1 1 1v8.586l2.293-2.293a1 1 0 1 1 1.414 1.414l-4 4a1 1 0 0 1-1.414 0l-4-4a1 1 0 0 1 1.414-1.414L11 12.586V4a1 1 0 0 1 1-1Z"}),r.jsx("path",{d:"M5 18a1 1 0 0 1 1 1v1h12v-1a1 1 0 1 1 2 0v2a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1Z"})]}),"Download MP4"]}),r.jsx("a",{href:D,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 rounded-full border border-gray-600 px-5 py-2 text-sm font-semibold text-gray-100 hover:border-blue-400 hover:text-blue-300",children:"View in new tab"})]})]}),r.jsx("div",{className:"rounded-xl border border-gray-800 overflow-hidden bg-black",children:r.jsx("video",{controls:!0,src:D,className:"w-full max-h-[480px] object-contain"})})]}),"create"===K&&renderHistory()]}),"history"===K&&renderHistory()]})}function TalkingHeadPage(){return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col text-white",children:[r.jsx("header",{className:"shrink-0 pt-12 md:pt-20 px-6 md:px-12 lg:px-20 max-w-6xl mx-auto w-full",children:r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h1",{className:"text-3xl md:text-4xl font-semibold tracking-tight",children:"Talking Head"})})}),r.jsx("main",{children:r.jsx("div",{className:"px-6 md:px-12 lg:px-20 max-w-6xl mx-auto pb-8",children:(0,r.jsxs)("section",{className:"mt-12 mx-auto w-full max-w-3xl bg-gray-800 rounded-lg p-8 shadow-lg",children:[r.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Generate a Talking Head"}),r.jsx("p",{className:"text-gray-300 mb-6",children:"Upload a face photo, enter a script, choose a voice, and we’ll render a video."}),r.jsx(UploadTalkingHead,{})]})})})]})}},72663:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$typeof:()=>n,__esModule:()=>s,default:()=>i});var r=t(95153);let l=(0,r.createProxy)(String.raw`/Users/theodorosiakovou/Projects/ai-platform/src/app/dashboard/talking-head/page.tsx`),{__esModule:s,$$typeof:n}=l,o=l.default,i=o}};var a=require("../../../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[2006,580,2767,3945,5892],()=>__webpack_exec__(98466));module.exports=t})();