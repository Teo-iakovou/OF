"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[842],{106:function(t,e,r){r.d(e,{Z:function(){return Insights}});var a=r(7437),n=r(2265),clipboard=t=>{let{text:e,label:r="Copy",copiedLabel:o="✓ Copied",className:i="",onCopied:s}=t,{copied:c,copy:l}=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3,[e,r]=(0,n.useState)(!1),copy=async e=>{if(e)try{await navigator.clipboard.writeText(e),r(!0),setTimeout(()=>r(!1),t)}catch(t){console.error("Failed to copy: ",t)}};return{copied:e,copy}}(),handleClick=async()=>{await l(e),null==s||s()};return(0,a.jsx)("button",{type:"button",onClick:handleClick,className:"px-3 py-1.5 rounded-lg text-white text-sm ".concat(i),"aria-live":"polite",children:c?o:r})},o=r(6354),i=r(9172),s=r(8409);let Pill=t=>{let{children:e}=t;return(0,a.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs bg-gray-800 text-gray-200 border border-gray-700",children:e})},displayPlatform=t=>"Twitter"===t?"X":t,c={X:(0,a.jsx)(s.LCd,{className:"w-5 h-5"}),Twitter:(0,a.jsx)(s.LCd,{className:"w-5 h-5"}),Reddit:(0,a.jsx)(i.ViA,{className:"w-5 h-5"}),Instagram:(0,a.jsx)(i.Zf_,{className:"w-5 h-5"}),TikTok:(0,a.jsx)(i.nTm,{className:"w-5 h-5"})},l={X:"from-zinc-700/80 to-zinc-500/80",Twitter:"from-[#1D9BF0]/60 to-[#1D9BF0]/30",Reddit:"from-[#FF4500]/70 to-[#FF8717]/60",Instagram:"from-[#F58529]/70 to-[#DD2A7B]/70",TikTok:"from-[#25F4EE]/70 to-[#FE2C55]/70"},d={X:"from-black to-zinc-900",Twitter:"from-[#1D9BF0] to-[#1D9BF0]",Reddit:"from-[#FF4500] to-[#FF8717]",Instagram:"from-[#F58529] via-[#DD2A7B] to-[#8134AF]",TikTok:"from-[#25F4EE] to-[#FE2C55]"};function PlatformCard(t){var e,r;let{rec:i}=t,s=(null===(e=i.bestTimesLocal)||void 0===e?void 0:e[0])||"—",u=function(t){var e;let r=(t.caption||"").trim(),a=(null===(e=t.link)||void 0===e?void 0:e.url)||"",n=(t.hashtags||[]).join(" ");if("Instagram"===t.platform||"TikTok"===t.platform)return{primary:{kind:"copy",label:"Copy caption",text:r},secondary:a?{kind:"copy",label:"Copy bio link",text:a}:void 0};if("Twitter"===t.platform||"X"===t.platform){let t=new URL("https://twitter.com/intent/tweet");return r&&t.searchParams.set("text",r),a&&t.searchParams.set("url",a),{primary:{kind:"link",label:"Open X compose",href:t.toString()},secondary:n?{kind:"copy",label:"Copy hashtags",text:n}:void 0}}return"Reddit"===t.platform?{primary:{kind:"copy",label:"Copy title/caption",text:r},secondary:{kind:"link",label:"Open Reddit",href:"https://www.reddit.com/submit"}}:{primary:{kind:"copy",label:"Copy caption",text:r},secondary:a?{kind:"copy",label:"Copy link",text:a}:void 0}}(i),p=displayPlatform(i.platform),h=null!==(r=c[i.platform])&&void 0!==r?r:c[p],f=l[i.platform]||l[p]||"from-purple-500/70 to-indigo-500/70",m=d[i.platform]||d[p]||"from-purple-500 to-indigo-500",y=(0,n.useRef)(null),[x,v]=(0,n.useState)(!1);async function toggleTTS(){try{if(x){var t;null===(t=y.current)||void 0===t||t.pause(),y.current=null,v(!1);return}if(!i.caption)return;let e=await (0,o.TD)(i.caption),r=new Audio(e);y.current=r,r.onended=()=>v(!1),r.onerror=()=>v(!1),v(!0),await r.play().catch(()=>v(!1))}catch(t){v(!1)}}return(0,n.useEffect)(()=>()=>{y.current&&(y.current.pause(),y.current=null)},[]),(0,a.jsx)("div",{className:"rounded-2xl p-[1.5px] bg-gradient-to-br ".concat(f," shadow-[0_0_0_1px_rgba(255,255,255,0.04)] h-full"),children:(0,a.jsxs)("div",{className:"rounded-2xl bg-[#0A0F1E]/90 px-5 py-5 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-gradient-to-br ".concat(m," text-white"),children:h}),(0,a.jsx)("div",{className:"text-xl font-semibold text-white tracking-tight",children:p})]}),(0,a.jsxs)("span",{className:"px-2.5 py-1 rounded-full text-[10px] font-medium bg-white/5 border border-white/10 text-white/80",children:["Best: ",s]})]}),i.caption?(0,a.jsx)("div",{className:"mt-3 flex-1 w-full text-[15px] leading-relaxed text-gray-100 whitespace-pre-wrap break-words",children:i.caption}):(0,a.jsx)("div",{className:"mt-3 flex-1 w-full text-[15px] leading-relaxed text-gray-400 italic",children:"No caption (fast mode)"}),(0,a.jsxs)("div",{className:"mt-4 flex items-center gap-3",children:["link"===u.primary.kind?(0,a.jsx)("a",{className:"w-full sm:w-auto inline-flex items-center justify-center rounded-xl px-4 py-2 bg-gradient-to-b from-indigo-500 to-blue-600 text-white font-semibold shadow-[0_8px_24px_rgba(56,97,251,0.35)] hover:brightness-110 transition",href:u.primary.href,target:"_blank",rel:"noreferrer",children:u.primary.label}):(0,a.jsx)(clipboard,{label:u.primary.label,text:u.primary.text,className:"w-full sm:w-auto rounded-xl px-4 py-2 bg-gradient-to-b from-indigo-500 to-blue-600 hover:brightness-110 text-white font-semibold shadow-[0_8px_24px_rgba(56,97,251,0.35)]"}),i.caption&&(0,a.jsx)("button",{type:"button",onClick:toggleTTS,className:"inline-flex items-center justify-center rounded-xl px-3 py-2 border border-gray-600 text-gray-200 hover:text-white hover:bg-white/5",children:x?"Stop":"Generate voice-over"})]})]})})}function Insights(t){var e,r,o,i,s;let{result:c}=t,l=(0,n.useMemo)(()=>{var t;return(null==c?void 0:null===(t=c.promotion)||void 0===t?void 0:t.recommendedPlatforms)||[]},[null==c?void 0:null===(e=c.promotion)||void 0===e?void 0:e.recommendedPlatforms]),[d,u]=(0,n.useState)(!1),p=(0,n.useMemo)(()=>{var t,e;if(!l.length)return null;let r=l[0],a=l[1];return{line1:"Post on ".concat(r.platform," at ").concat((null===(t=r.bestTimesLocal)||void 0===t?void 0:t[0])||"—","."),line2:a?"Backup: ".concat(a.platform," at ").concat((null===(e=a.bestTimesLocal)||void 0===e?void 0:e[0])||"—","."):""}},[l]),h=(0,n.useMemo)(()=>{var t;let e=[];c.niche&&e.push("Niche: ".concat(c.niche)),"number"==typeof c.csl&&e.push("CSL: ".concat(c.csl,"/3")),c.hasFace&&e.push("Face detected");let r=null==c?void 0:null===(t=c.meta)||void 0===t?void 0:t.timezone;return r&&e.push("TZ: ".concat(r)),e},[c]);return(0,a.jsxs)("div",{className:"w-full space-y-6",children:[(0,a.jsxs)("div",{className:"text-center max-w-3xl mx-auto",children:[(0,a.jsx)("h3",{className:"text-4xl md:text-5xl font-extrabold tracking-tight bg-gradient-to-b from-purple-200 via-purple-300 to-indigo-300 bg-clip-text text-transparent drop-shadow-[0_6px_24px_rgba(124,58,237,0.35)]",children:"Your AI Insights"}),p&&(0,a.jsxs)("div",{className:"mt-3 leading-snug",children:[(0,a.jsx)("p",{className:"text-base md:text-lg text-gray-200/90",children:p.line1}),p.line2?(0,a.jsx)("p",{className:"text-base md:text-lg text-gray-200/70",children:p.line2}):null]})]}),(0,a.jsx)("div",{className:"grid md:grid-cols-2 gap-4",children:l.map((t,e)=>(0,a.jsx)(PlatformCard,{rec:t},"".concat(t.platform,"-").concat(e)))}),(null==c?void 0:null===(o=c.promotion)||void 0===o?void 0:null===(r=o.ctaVariants)||void 0===r?void 0:r.length)?(0,a.jsxs)("div",{className:"rounded-xl border border-gray-700 bg-gray-900 p-4",children:[(0,a.jsx)("div",{className:"text-sm font-semibold mb-2 text-white",children:"CTA Ideas"}),(0,a.jsx)("ul",{className:"list-disc pl-5 text-sm text-gray-300 space-y-1",children:c.promotion.ctaVariants.map((t,e)=>(0,a.jsx)("li",{children:t},e))})]}):null,(0,a.jsx)("div",{className:"pt-1",children:(0,a.jsx)("button",{onClick:()=>u(t=>!t),className:"text-xs text-gray-400 underline hover:text-gray-200",children:d?"Hide advanced details":"Show advanced details"})}),d&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsx)("div",{className:"rounded-xl border border-gray-700 bg-gray-900 p-4 space-y-2",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:h.map((t,e)=>(0,a.jsx)(Pill,{children:t},e))})}),(0,a.jsxs)("div",{className:"rounded-xl border border-gray-700 bg-gray-900 p-4",children:[(0,a.jsx)("div",{className:"text-sm font-semibold mb-2 text-white",children:"Safety Notes"}),(null===(s=c.promotion)||void 0===s?void 0:null===(i=s.riskFlags)||void 0===i?void 0:i.length)?(0,a.jsx)("ul",{className:"list-disc pl-5 text-sm text-gray-300 space-y-1",children:c.promotion.riskFlags.map((t,e)=>(0,a.jsx)("li",{children:t},e))}):(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"—"})]})]})]})}},6354:function(t,e,r){r.d(e,{BT:function(){return createEmptyConversation},Do:function(){return purchasePackage},Ii:function(){return deleteAnalysisResult},Kc:function(){return coachChat},Nn:function(){return checkUserPackage},TD:function(){return ttsSynthesize},Um:function(){return fetchConversation},Vv:function(){return startCheckout},fA:function(){return sendFeedback},ku:function(){return fetchConversations},lG:function(){return fetchCoachChatPrompts},mF:function(){return analyzeImageMultipart},mI:function(){return fetchAnalysisHistory},sm:function(){return clearApiCaches},uh:function(){return generateConversationTitle}});var a=r(2205),n=r(2601);async function readJsonOrText(t){let e=await t.text();try{return{ok:t.ok,status:t.status,data:JSON.parse(e)}}catch(r){return{ok:t.ok,status:t.status,data:e}}}function ensureOk(t,e){if(!t.ok){let r="string"==typeof t.data?t.data:JSON.stringify(t.data,null,2);throw Error("".concat(e," failed (").concat(t.status,") - ").concat(r))}return t.data}async function fetchAnalysisHistory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r="".concat(a._,"/api/analyze?page=").concat(t,"&limit=").concat(e,"&ts=").concat(Date.now()),n=await (0,a.r)(r,{method:"GET",cache:"no-store"});if(!n.ok)throw Error("Fetch analysis history failed");return n.data}async function deleteAnalysisResult(t){let e=await fetch("".concat(a._,"/api/analyze/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json"}}),r=await readJsonOrText(e);return ensureOk(r,"Delete analysis result")}async function startCheckout(t){let e="true"===n.env.NEXT_PUBLIC_USE_BFF,r=e?"/api/checkout/create-checkout-session":"".concat(a._,"/api/checkout/create-checkout-session"),o=await fetch(r,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageId:t})}),{ok:i,data:s}=await readJsonOrText(o);if(!i)throw Error("string"==typeof s?s:(null==s?void 0:s.error)||"Failed to start checkout");if(!(null==s?void 0:s.url))throw Error("No checkout URL returned");window.location.href=s.url}async function purchasePackage(t){let e="true"===n.env.NEXT_PUBLIC_USE_BFF,r=e?"/api/user/purchase":"".concat(a._,"/api/user/purchase"),o=await fetch(r,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageId:t})}),i=await readJsonOrText(o);return ensureOk(i,"Purchase package")}async function checkUserPackage(){let t=Date.now();return void 0!==o.value&&t-o.ts<5e3?o.value:(o.inFlight||(o.inFlight=(async()=>{try{let t=await (0,a.r)("".concat(a._,"/api/user/check-package"),{method:"GET",cache:"no-store"});if(!t.ok)throw Error("Check user package failed");let e=t.data;return o.value=e,o.ts=Date.now(),e}catch(t){if("object"==typeof t&&null!==t&&("number"==typeof t.status&&401===t.status||"string"==typeof t.message&&"Unauthorized"===t.message))return{hasAccess:!1};throw t}finally{o.inFlight=null}})()),o.inFlight)}let o={value:void 0,ts:0,inFlight:null};function clearApiCaches(){o.value=void 0,o.ts=0,o.inFlight=null}async function coachChat(t){let{question:e,latestContentInfo:r,conversationId:n,title:o}=t;try{let t=await fetch("".concat(a._,"/api/coach-chat"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({question:e,latestContentInfo:r,conversationId:n,title:o})}),i=await readJsonOrText(t);if(200===t.status)return{status:200,data:i.data};if(402===t.status)return{status:402,data:i.data};if(429===t.status)return{status:429,data:i.data};return{status:t.status,data:i.data}}catch(t){return{status:0,data:{error:"Network error"}}}}async function fetchConversation(t){let e=await fetch("".concat(a._,"/api/conversations/").concat(t),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include",cache:"no-store"}),r=await readJsonOrText(e);return ensureOk(r,"Fetch conversation")}async function createEmptyConversation(){try{var t,e;let r=await fetch("".concat(a._,"/api/conversations"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),n=await readJsonOrText(r),o=ensureOk(n,"Create conversation");return null!==(e=null!==(t=o._id)&&void 0!==t?t:o.id)&&void 0!==e?e:null}catch(t){return console.error("Error creating new conversation:",t),null}}async function generateConversationTitle(t,e){let r=await fetch("".concat(a._,"/api/conversations/").concat(t,"/generate-title"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({firstUserMessage:e}),cache:"no-store"}),n=await readJsonOrText(r),o=ensureOk(n,"Generate title");return o.title||null}async function fetchConversations(){let t="".concat(a._,"/api/conversations?ts=").concat(Date.now()),e=await (0,a.r)(t,{method:"GET",cache:"no-store"});if(!e.ok)throw Error("Fetch conversations failed");return e.data}async function sendFeedback(t){let e=await fetch("".concat(a._,"/api/feedback"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t})}),r=await readJsonOrText(e);if(!r.ok){var n;throw Error("string"==typeof r.data?r.data:(null===(n=r.data)||void 0===n?void 0:n.error)||"Failed to send feedback (".concat(r.status,")"))}return r.data}function analyzeImageMultipart(t){let{file:e,goal:r,linkBase:n,onProgress:o,captions:i=!0,signal:s}=t,c=new FormData;c.append("image",e),r&&c.append("goal",r),n&&c.append("linkBase",n);try{let t=Intl.DateTimeFormat().resolvedOptions().timeZone;t&&c.append("timezone",t)}catch(t){}let l="".concat(a._,"/api/analyze")+(!1===i?"?captions=false":"");return new Promise((t,e)=>{let r=new XMLHttpRequest;r.open("POST",l,!0),r.withCredentials=!0,r.onreadystatechange=()=>{if(4===r.readyState){if(r.status>=200&&r.status<300)try{let e=JSON.parse(r.responseText);t(e)}catch(t){e(Error("Invalid JSON from server."))}else try{let t=JSON.parse(r.responseText);e(Error((null==t?void 0:t.error)||"Upload failed (".concat(r.status,")")))}catch(t){e(Error("Upload failed (".concat(r.status,")")))}}},r.upload&&"function"==typeof o&&(r.upload.onprogress=t=>{t.lengthComputable&&o(Math.round(t.loaded/t.total*100))}),r.onerror=()=>e(Error("Network error"));let a=!1,onAbort=()=>{a=!0;try{r.abort()}catch(t){}e(new DOMException("Aborted","AbortError"))};if(s){if(s.aborted)return onAbort();s.addEventListener("abort",onAbort,{once:!0})}r.send(c);let cleanup=()=>{s&&s.removeEventListener("abort",onAbort)};r.onloadend=()=>{a||cleanup()}})}async function fetchCoachChatPrompts(){let t="".concat(a._,"/api/coach-chat/prompts?ts=").concat(Date.now()),e=await (0,a.r)(t,{method:"GET",cache:"no-store"});if(!e.ok)throw Error("Fetch coach prompts failed");return e.data}async function ttsSynthesize(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URLSearchParams({text:t});return e.voiceId&&r.set("voiceId",e.voiceId),e.format&&r.set("format",e.format),r.set("ts",String(Date.now())),"".concat(a._,"/api/tts?").concat(r.toString())}},2205:function(t,e,r){r.d(e,{_:function(){return n},r:function(){return fetchJson}});var a=r(2601);let n=a.env.NEXT_PUBLIC_API_URL||"http://localhost:5001";async function fetchJson(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="true"===a.env.NEXT_PUBLIC_USE_BFF,o=t;try{if(r&&"string"==typeof t)for(let e of["/api/auth/","/api/checkout/","/api/user/"]){if(t.startsWith(n+e)){o=t.slice(n.length);break}let r=t.indexOf(e);if(t.startsWith("http")&&-1!==r){o=t.slice(r);break}}}catch(t){}let i="true"===a.env.NEXT_PUBLIC_HEADER_AUTH,s=new Headers(e.headers);s.has("content-type")||s.set("Content-Type","application/json");try{if(i){var c;let t=null===(c=window.localStorage)||void 0===c?void 0:c.getItem("ai_token");t&&!s.has("authorization")&&s.set("Authorization","Bearer ".concat(t))}}catch(t){}let l=await fetch(o,{...e,credentials:"include",headers:s}),d=await l.text(),u=null;try{u=d?JSON.parse(d):null}catch(t){u=d}if(401===l.status){let t=Error("Unauthorized");throw t.status=401,t.data=u,t}return{ok:l.ok,status:l.status,data:u}}},3118:function(t,e,r){r.d(e,{w_:function(){return GenIcon}});var a=r(2265),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o=a.createContext&&a.createContext(n),i=["attr","size","title"];function _extends(){return(_extends=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t}).apply(this,arguments)}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){var a,n;a=e,n=r[e],(a=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,e||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(a))in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function GenIcon(t){return e=>a.createElement(IconBase,_extends({attr:_objectSpread({},t.attr)},e),function Tree2Element(t){return t&&t.map((t,e)=>a.createElement(t.tag,_objectSpread({key:e},t.attr),Tree2Element(t.child)))}(t.child))}function IconBase(t){var elem=e=>{var r,{attr:n,size:o,title:s}=t,c=function(t,e){if(null==t)return{};var r,a,n=function(t,e){if(null==t)return{};var r={};for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){if(e.indexOf(a)>=0)continue;r[a]=t[a]}return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)r=o[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}(t,i),l=o||e.size||"1em";return e.className&&(r=e.className),t.className&&(r=(r?r+" ":"")+t.className),a.createElement("svg",_extends({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},e.attr,n,c,{className:r,style:_objectSpread(_objectSpread({color:t.color||e.color},e.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&a.createElement("title",null,s),t.children)};return void 0!==o?a.createElement(o.Consumer,null,t=>elem(t)):elem(n)}}}]);