(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{5425:function(e,t,n){Promise.resolve().then(n.bind(n,5437))},3400:function(e,t,n){"use strict";n.d(t,{C:function(){return useConsent},x:function(){return ConsentProvider}});var r=n(7437),a=n(2265);let s="consent.v1",i=(0,a.createContext)(null);function ConsentProvider(e){let{children:t}=e,[n,o]=(0,a.useState)(!1),[l,c]=(0,a.useState)(null);(0,a.useEffect)(()=>{try{let e=localStorage.getItem(s);if(e){let t=JSON.parse(e);c(t);return}}catch(e){}let e="undefined"!=typeof navigator&&!0===navigator.globalPrivacyControl,t={categories:{necessary:!0,analytics:!1,marketing:!1},timestamp:Date.now(),locale:"undefined"!=typeof navigator?navigator.language:void 0,version:"1.0",gpc:e};c(t),o(!0)},[]);let d=(0,a.useCallback)(()=>o(!0),[]),u=(0,a.useCallback)(()=>o(!1),[]),h=(0,a.useCallback)(async e=>{let t="undefined"!=typeof navigator&&!0===navigator.globalPrivacyControl,n={categories:{necessary:!0,...e},timestamp:Date.now(),locale:"undefined"!=typeof navigator?navigator.language:void 0,version:"1.0",gpc:t};c(n);try{localStorage.setItem(s,JSON.stringify(n))}catch(e){}try{fetch("/api/consent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}catch(e){}o(!1)},[]),f=(0,a.useMemo)(()=>({consent:l,open:d,close:u,save:h,isOpen:n}),[l,d,u,h,n]);return(0,r.jsx)(i.Provider,{value:f,children:t})}function useConsent(){let e=(0,a.useContext)(i);if(!e)throw Error("useConsent must be used within ConsentProvider");return e}},44:function(e,t,n){"use strict";n.r(t);var r=n(7437);n(2265),t.default=()=>(0,r.jsx)("div",{className:"flex items-center justify-center w-full h-32",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute -inset-2 rounded-full bg-gradient-to-tr from-cyan-500/20 to-fuchsia-500/20 blur-md animate-pulse"}),(0,r.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-cyan-400/30 border-t-cyan-400 animate-spin"})]})})},5437:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return LayoutClient}});var r=n(7437),a=n(2265),s=n(4033),i=n(44),o=n(1396),l=n.n(o),c=n(5119),d=n(1541),u=n(8244),h=n(2176),f=n(8339),x=n(7972),m=n(7660),b=n(6691),g=n.n(b);let p=[{href:"/dashboard",label:"Overview",icon:c.Z},{href:"/dashboard/upload",label:"Upload Content",icon:d.Z},{href:"/dashboard/history",label:"Upload History",icon:u.Z},{href:"/dashboard/ai-chat",label:"AI Chat",icon:h.Z},{href:"/dashboard/talking-head",label:"Talking Head",icon:f.Z},{href:"/dashboard/account",label:"Account & Billing",icon:x.Z}];function DashboardSidebar(e){let{expanded:t,setExpanded:n}=e,a=(0,s.usePathname)(),isItemActive=e=>!!e&&("/dashboard"===e?a===e:null==a?void 0:a.startsWith(e));return(0,r.jsxs)("nav",{className:"\n        bg-[#171d29] rounded-2xl shadow-2xl flex flex-col justify-between items-center\n        transition-all duration-200 fixed top-6 left-4\n        ".concat(t?"w-64":"w-16","\n        py-4 px-2 z-30\n      "),style:{minWidth:t?256:64,maxWidth:t?256:64,height:"calc(100vh - 3rem)"},children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 pt-2",children:[(0,r.jsx)("div",{role:"button",tabIndex:0,className:"flex items-center justify-center w-10 h-10 rounded-xl text-blue-300 hover:text-white transition cursor-pointer select-none",onClick:()=>n(!t),"aria-label":t?"Collapse sidebar":"Expand sidebar",title:t?"Collapse sidebar":"Expand sidebar",onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&n(!t)},children:(0,r.jsx)(m.Z,{size:22,className:t?"":"rotate-180 transition-transform duration-300"})}),(0,r.jsx)("ul",{className:"flex flex-col items-center gap-2 mt-2",children:p.map(e=>{let n=e.icon,a=isItemActive(e.href),s="flex items-center gap-3 px-3 py-2 rounded-xl cursor-pointer font-medium text-base transition-colors duration-150 w-full",i="text-blue-300 hover:bg-[#232B36]";return(0,r.jsxs)("li",{className:"relative group",children:[e.href?(0,r.jsx)(l(),{href:e.href,children:(0,r.jsxs)("span",{className:"".concat(s," ").concat(a?"bg-blue-600 text-white":i),children:[(0,r.jsx)(n,{size:22}),t&&(0,r.jsx)("span",{className:"whitespace-nowrap",children:e.label})]})}):(0,r.jsxs)("span",{className:"".concat(s," ").concat(i),children:[(0,r.jsx)(n,{size:22}),t&&(0,r.jsx)("span",{className:"whitespace-nowrap",children:e.label})]}),!t&&(0,r.jsx)("div",{className:"absolute left-full top-1/2 -translate-y-1/2 ml-2 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto bg-black text-white px-3 py-1 rounded shadow-lg text-xs font-semibold z-50 transition whitespace-nowrap",children:e.label})]},e.label)})})]}),(0,r.jsx)("div",{className:"flex flex-col items-center text-white",children:(0,r.jsx)(l(),{href:"/",className:"flex flex-col items-center group transition",children:(0,r.jsx)(g(),{src:"/echofy-removebg-preview.png",alt:"Platform Logo",width:56,height:56,className:"rounded-full object-cover border border-gray-700 group-hover:scale-105 transition"})})})]})}let v=(0,a.createContext)(null),y="floatingChat.pos",w="floatingChat.open";function FloatingChatProvider(e){let{children:t,email:n}=e,[s,i]=(0,a.useState)(!1),[o,l]=(0,a.useState)({x:24,y:24}),[c,d]=(0,a.useState)(null);(0,a.useEffect)(()=>{try{let e=localStorage.getItem(y);if(e){let t=JSON.parse(e);"number"==typeof(null==t?void 0:t.x)&&"number"==typeof(null==t?void 0:t.y)&&l(t)}let t=localStorage.getItem(w);"1"===t&&i(!0)}catch(e){}},[]);let u=(0,a.useCallback)(e=>{l(e);try{localStorage.setItem(y,JSON.stringify(e))}catch(e){}},[]),h=(0,a.useCallback)(e=>{e&&d(e),i(!0);try{localStorage.setItem(w,"1")}catch(e){}},[]),f=(0,a.useCallback)(()=>{i(!1);try{localStorage.setItem(w,"0")}catch(e){}},[]),x=(0,a.useCallback)(()=>{i(e=>{let t=!e;try{localStorage.setItem(w,t?"1":"0")}catch(e){}return t})},[]),m=(0,a.useMemo)(()=>({isOpen:s,open:h,close:f,toggle:x,anchor:o,setAnchor:u,contextRef:c,setContextRef:d,email:n}),[s,h,f,x,o,u,c,n]);return(0,r.jsx)(v.Provider,{value:m,children:t})}var j=n(4887),C=n(6307),N=n(2187),k=n(2549),E=n(8811),S=n.n(E),I=n(6354);let P=S()(()=>n.e(445).then(n.bind(n,9445)),{loadableGenerated:{webpack:()=>[9445]},ssr:!1}),z=S()(()=>n.e(817).then(n.bind(n,5817)),{loadableGenerated:{webpack:()=>[5817]},ssr:!1});function FloatingChatWidget(){let e=function(){let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>t(!0),[]),e}(),{isOpen:t,open:n,close:s,anchor:i,setAnchor:o}=function(){let e=(0,a.useContext)(v);if(!e)throw Error("useFloatingChat must be used within FloatingChatProvider");return e}(),[l,c]=(0,a.useState)(),[d,u]=(0,a.useState)(0),[f,x]=(0,a.useState)(!1),m=(0,a.useRef)(null),b=(0,a.useRef)(null),g=(0,a.useRef)(null),p=(0,a.useRef)(i);(0,a.useEffect)(()=>{p.current=i},[i]),(0,a.useEffect)(()=>{if(24===i.x&&24===i.y){let e=y(window.innerWidth-48-24,window.innerHeight-48-24,48,48);o(e)}},[]);let y=(0,a.useCallback)((e,t,n,r)=>{let a=Math.max(12,window.innerWidth-n-12),s=Math.max(12,window.innerHeight-r-12);return{x:Math.min(Math.max(e,12),a),y:Math.min(Math.max(t,12),s)}},[]),w=(0,a.useRef)({dragging:!1,startX:0,startY:0,startAnchor:{x:0,y:0},raf:0,pending:{x:0,y:0}}),E=(0,a.useCallback)(e=>{let t=e.currentTarget;w.current.dragging=!0,w.current.startX=e.clientX,w.current.startY=e.clientY,w.current.startAnchor={...p.current},w.current.pending=p.current;try{var n;null===(n=t.setPointerCapture)||void 0===n||n.call(t,e.pointerId)}catch(e){}e.preventDefault(),document.body.style.userSelect="none",t.style.touchAction="none";let onMove=e=>{if(!w.current.dragging)return;let t=e.clientX-w.current.startX,n=e.clientY-w.current.startY,r=y(w.current.startAnchor.x+t,w.current.startAnchor.y+n,48,48);w.current.pending=r,w.current.raf||(w.current.raf=requestAnimationFrame(()=>{w.current.raf=0;let e=w.current.pending;(e.x!==p.current.x||e.y!==p.current.y)&&o(e)}))},onUp=e=>{if(w.current.dragging){w.current.dragging=!1;try{var n;null===(n=t.releasePointerCapture)||void 0===n||n.call(t,e.pointerId)}catch(e){}document.body.style.userSelect="",window.removeEventListener("pointermove",onMove),window.removeEventListener("pointerup",onUp),w.current.raf&&cancelAnimationFrame(w.current.raf),w.current.raf=0}};window.addEventListener("pointermove",onMove,{passive:!0}),window.addEventListener("pointerup",onUp,{passive:!0})},[y,o]);if((0,a.useEffect)(()=>{let onResize=()=>{let e=p.current,t=y(e.x,e.y,48,48);(t.x!==e.x||t.y!==e.y)&&o(t)};return window.addEventListener("resize",onResize),()=>window.removeEventListener("resize",onResize)},[y,o]),(0,a.useEffect)(()=>{if(!t)return;let onDocClick=e=>{if(!g.current||!b.current)return;let t=e.target;g.current.contains(t)||b.current.contains(t)||(s(),x(!1))},onEsc=e=>{"Escape"===e.key&&(s(),x(!1))};return document.addEventListener("mousedown",onDocClick),document.addEventListener("keydown",onEsc),()=>{document.removeEventListener("mousedown",onDocClick),document.removeEventListener("keydown",onEsc)}},[t,s]),(0,a.useEffect)(()=>{if(!f)return;let onDown=e=>{m.current&&(m.current.contains(e.target)||x(!1))};return document.addEventListener("mousedown",onDown),()=>document.removeEventListener("mousedown",onDown)},[f]),!e)return null;async function handleNewChat(){let e=await (0,I.BT)();e&&c(e),u(e=>e+1)}return(0,j.createPortal)((0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{ref:b,"aria-label":"AI Coach",onPointerDown:E,onClick:()=>{w.current.dragging||(t?(s(),x(!1)):n())},style:{position:"fixed",left:0,top:0,transform:"translate3d(".concat(i.x,"px, ").concat(i.y,"px, 0)"),zIndex:2147483647,touchAction:"none",willChange:"transform"},className:"h-12 w-12 rounded-full shadow-lg border border-gray-700 bg-gray-900 text-white flex items-center justify-center cursor-grab active:cursor-grabbing active:scale-95",children:(0,r.jsx)(h.Z,{className:"h-6 w-6"})}),(0,r.jsx)(C.M,{children:t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},onClick:()=>{s(),x(!1)},style:{position:"fixed",inset:0,zIndex:2147483645},className:"bg-black/30 backdrop-blur-sm"}),(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4 md:p-6",style:{zIndex:2147483646,pointerEvents:"none"},children:(0,r.jsxs)(N.E.div,{ref:g,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},transition:{type:"spring",stiffness:260,damping:24},style:{width:420,maxWidth:"95vw",height:560,maxHeight:"80vh",willChange:"transform",pointerEvents:"auto"},className:"rounded-2xl shadow-2xl border border-[#232B36] bg-[#0f1520] overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"relative px-4 py-2 border-b border-[#232B36] bg-[#121A24] text-gray-200 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"AI Coach"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>x(e=>!e),className:"px-2 py-1 text-xs rounded text-white bg-gray-700 hover:bg-gray-600 transition",children:"History"}),(0,r.jsx)("button",{onClick:()=>{s(),x(!1)},className:"p-1 rounded-md hover:bg-[#1f2732]","aria-label":"Close",children:(0,r.jsx)(k.Z,{className:"h-4 w-4"})})]}),f&&(0,r.jsx)("div",{ref:m,className:"absolute right-2 top-full mt-2 z-[100] w-[320px]",children:(0,r.jsx)(z,{onSelect:e=>{c(e),x(!1)},selectedId:l,refreshKey:d,showHeader:!0,onNew:handleNewChat,maxHeight:420})})]}),(0,r.jsx)("div",{className:"flex-1 min-h-0",children:(0,r.jsx)(P,{initialConversationId:l,onNewConversation:e=>{c(e),u(e=>e+1)}})})]})})]})})]}),document.body)}let A=[{href:"/dashboard",label:"Overview"},{href:"/dashboard/upload",label:"Upload Content"},{href:"/dashboard/history",label:"Upload History"},{href:"/dashboard/talking-head",label:"Talking Heads"},{href:"/dashboard/ai-chat",label:"AI Chat"},{href:"/dashboard/account",label:"Account Info"}];function MobileProjectNavDrawer(e){let{open:t,onClose:n}=e;return t?(0,r.jsxs)("div",{className:"fixed inset-0 z-[2147483648]",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:n,"aria-hidden":!0}),(0,r.jsxs)("div",{className:"absolute left-0 top-0 h-full w-[84vw] max-w-[320px] bg-[#0f1520] border-r border-[#232B36] shadow-2xl flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[#232B36] text-gray-200",children:[(0,r.jsx)("span",{className:"font-medium",children:"Project Navigation"}),(0,r.jsx)("button",{"aria-label":"Close navigation",className:"p-1 rounded hover:bg-[#1f2732]",onClick:n,children:(0,r.jsx)(k.Z,{className:"h-5 w-5"})})]}),(0,r.jsx)("nav",{className:"flex-1 overflow-y-auto",children:(0,r.jsxs)("ul",{className:"py-2",children:[A.map(e=>(0,r.jsx)("li",{children:(0,r.jsx)(l(),{href:e.href,className:"block px-5 py-3 text-gray-100 hover:text-cyan-400 hover:bg-gray-800 transition",onClick:n,children:e.label})},e.href)),(0,r.jsx)("li",{className:"border-t border-gray-700 mt-2 pt-2",children:(0,r.jsx)(l(),{href:"/",className:"block px-5 py-3 text-red-400 hover:text-red-500 hover:bg-gray-800 transition font-semibold",onClick:n,children:"Exit Dashboard"})})]})})]})]}):null}var D=n(8004),L=n(3400),M=n(388);function LayoutClient(e){let{children:t,initialUser:n}=e,[o,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!1),{open:f}=(0,L.C)(),{user:x,loading:m}=(0,M.a)({required:!0,initialUser:n}),b=(0,s.usePathname)();(0,a.useEffect)(()=>{d(!0)},[]);let g=!["/dashboard/ai-chat","/dashboard/ai-coach","/dashboard/coaching"].some(e=>null==b?void 0:b.startsWith(e));return c&&!m&&x?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(FloatingChatProvider,{children:(0,r.jsxs)("div",{className:"min-h-screen overflow-x-hidden bg-gradient-to-br from-gray-900 via-gray-800 to-black flex",children:[(0,r.jsx)("div",{className:"hidden md:flex fixed top-6 left-6 z-30 transition-all duration-200",style:{width:o?256:64,height:"calc(100svh - 3rem)",padding:"0.5rem 0"},children:(0,r.jsx)(DashboardSidebar,{expanded:o,setExpanded:l})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col transition-all duration-200 ".concat(o?"md:ml-64":"md:ml-16"),children:[(0,r.jsx)("main",{className:"px-6 pt-2",children:t}),g?(0,r.jsx)("div",{className:"h-4 shrink-0"}):null]}),!g&&(0,r.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none fixed inset-x-0 bottom-0 z-[5] bg-gradient-to-br from-gray-900 via-gray-800 to-black",style:{height:"env(safe-area-inset-bottom, 0px)"}}),g&&(0,r.jsx)(FloatingChatWidget,{}),(0,r.jsx)("div",{className:"md:hidden fixed top-3 left-3 z-40",children:(0,r.jsx)("button",{"aria-label":"Open navigation",onClick:()=>h(!0),className:"p-2 rounded-xl bg-[#171d29] border border-[#232B36] text-white shadow",children:(0,r.jsx)(D.Z,{size:20})})}),(0,r.jsx)(MobileProjectNavDrawer,{open:u,onClose:()=>h(!1)}),(0,r.jsx)("button",{onClick:f,className:"fixed bottom-3 right-3 z-40 text-xs text-gray-300/80 hover:text-white underline underline-offset-2",children:"Cookie preferences"})]})})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 text-white",children:(0,r.jsx)(i.default,{})})}}},function(e){e.O(0,[922,579,342,590,971,472,744],function(){return e(e.s=5425)}),_N_E=e.O()}]);