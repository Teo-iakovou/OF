(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[834],{2601:function(e,t,n){"use strict";var r,i;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(i=n.g.process)?void 0:i.env)?n.g.process:n(8960)},6547:function(e,t,n){Promise.resolve().then(n.bind(n,1228))},44:function(e,t,n){"use strict";n.r(t);var r=n(7437);n(2265),t.default=()=>(0,r.jsx)("div",{className:"flex items-center justify-center w-full h-32",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute -inset-2 rounded-full bg-gradient-to-tr from-cyan-500/20 to-fuchsia-500/20 blur-md animate-pulse"}),(0,r.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-cyan-400/30 border-t-cyan-400 animate-spin"})]})})},1228:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return HistoryPage}});var r=n(7437),i=n(2265),s=n(106),uploads_HistoryCard=e=>{var t,n,i;let{item:s,selectedItems:o,setSelectedItems:l,onDeleteClick:a,onOpenClick:c}=e,d=null===(n=s.promotion)||void 0===n?void 0:null===(t=n.recommendedPlatforms)||void 0===t?void 0:t[0],u=(null==d?void 0:d.platform)||"—",m=(null==d?void 0:null===(i=d.bestTimesLocal)||void 0===i?void 0:i[0])||"—",f=new Date(s.createdAt).toLocaleString();return(0,r.jsxs)("div",{role:"button",tabIndex:0,onClick:()=>c(s._id),onKeyDown:e=>"Enter"===e.key&&c(s._id),className:"flex items-center justify-between gap-4 bg-gray-800 border border-gray-700 p-4 sm:p-5 rounded-xl shadow-button hover:shadow-lg hover:bg-gray-800/80 transition cursor-pointer",children:[(0,r.jsx)("div",{className:"flex items-center gap-3 min-w-0",children:(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsxs)("div",{className:"text-white font-semibold truncate",children:["Analysis • ",f]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-0.5",children:[u," • Best ",m]})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),c(s._id)},className:"px-3 py-1.5 rounded-lg bg-sky-600 hover:bg-sky-700 text-white text-sm",children:"Open"}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),a(s._id)},className:"px-3 py-1.5 rounded-lg bg-rose-600 hover:bg-rose-700 text-white text-sm",children:"Delete"})]})]})},common_ConfirmModal=e=>{let{isOpen:t,title:n="Confirm Action",message:i="Are you sure you want to proceed?",onConfirm:s,onCancel:o}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",children:(0,r.jsxs)("div",{className:"bg-gray-900 rounded-xl shadow-lg p-6 max-w-sm w-full border border-gray-700",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-2",children:n}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:i}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:o,className:"px-4 py-2 text-sm bg-gray-700 text-white rounded-md hover:bg-gray-600",children:"Cancel"}),(0,r.jsx)("button",{onClick:s,className:"px-4 py-2 text-sm bg-red-500 text-white rounded-md hover:bg-red-600",children:"Delete"})]})]})}):null},uploads_HistoryList=e=>{let{history:t,selectedItems:n,setSelectedItems:s,onDeleteClick:o,onOpenClick:l}=e,[a,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)(null),openConfirmModal=e=>{u(e),c(!0)},confirmDelete=async()=>{d&&(o(d),c(!1),u(null))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4",children:t.map(e=>(0,r.jsx)(uploads_HistoryCard,{item:e,selectedItems:n,setSelectedItems:s,onDeleteClick:openConfirmModal,onOpenClick:l},e._id))}),(0,r.jsx)(common_ConfirmModal,{isOpen:a,title:"Delete Analysis",message:"Are you sure you want to delete this analysis? This action cannot be undone.",onCancel:()=>c(!1),onConfirm:confirmDelete})]})},o=n(6354),l=n(44);function HistoryPage(){let[e,t]=(0,i.useState)([]),[n,a]=(0,i.useState)([]),[c,d]=(0,i.useState)(!0),[u,m]=(0,i.useState)(null),f=(0,i.useCallback)(async()=>{d(!0);try{let{results:e}=await (0,o.mI)(1,20);t(e),m(t=>t&&e.some(e=>e._id===t._id)&&e.find(e=>e._id===t._id)||null)}catch(e){console.error("Failed to load history",e),t([]),m(null)}finally{d(!1)}},[]);(0,i.useEffect)(()=>{f()},[f]),(0,i.useEffect)(()=>{let onLocalStorage=e=>{"analysis:changed"===e.key&&f()},onCustom=()=>f(),onVisibility=()=>{"visible"===document.visibilityState&&f()};return window.addEventListener("storage",onLocalStorage),window.addEventListener("analysis:changed",onCustom),document.addEventListener("visibilitychange",onVisibility),()=>{window.removeEventListener("storage",onLocalStorage),window.removeEventListener("analysis:changed",onCustom),document.removeEventListener("visibilitychange",onVisibility)}},[f]);let handleDelete=async e=>{try{await (0,o.Ii)(e)}catch(e){console.error("Failed to delete item:",e)}finally{t(t=>t.filter(t=>t._id!==e)),a(t=>t.filter(t=>t!==e)),m(t=>(null==t?void 0:t._id)===e?null:t)}};return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col text-white",children:[(0,r.jsx)("header",{className:"shrink-0 pt-12 md:pt-20 px-4 md:px-12 lg:px-20 max-w-6xl mx-auto w-full",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-semibold tracking-tight",children:"Upload History"}),(0,r.jsx)("button",{onClick:f,className:"hidden md:inline px-3 py-1.5 rounded-lg bg-slate-600 hover:bg-slate-500 text-white text-sm",children:"Refresh"})]})}),(0,r.jsx)("main",{children:(0,r.jsx)("div",{className:"px-4 md:px-12 lg:px-20 max-w-6xl mx-auto pb-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,r.jsx)("section",{className:"bg-gray-800 rounded-xl p-4 md:p-6 shadow-button min-h-[280px]",children:c?(0,r.jsx)(l.default,{}):0===e.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-48",children:[(0,r.jsxs)("svg",{width:"40",height:"40",fill:"none",className:"mb-2 opacity-50",children:[(0,r.jsx)("circle",{cx:"20",cy:"20",r:"18",stroke:"#38bdf8",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M14 20l4 4 8-8",stroke:"#38bdf8",strokeWidth:"2"})]}),(0,r.jsx)("div",{className:"text-gray-400 text-lg",children:"No uploads yet. Start by uploading your first file!"})]}):(0,r.jsx)(uploads_HistoryList,{history:e,selectedItems:n,setSelectedItems:a,onDeleteClick:handleDelete,onOpenClick:t=>{let n=e.find(e=>e._id===t)||null;m(n)}})}),(0,r.jsx)("section",{className:"bg-gray-800 rounded-xl p-4 md:p-6 shadow-button min-h-[280px]",children:u?(0,r.jsx)("div",{className:"min-h-0",children:(0,r.jsx)(s.Z,{result:u})}):(0,r.jsx)("div",{className:"text-gray-400",children:"Select an item from the list to view insights."})})]})})})]})}},8960:function(e){!function(){var t={229:function(e){var t,n,r,i=e.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(e){if(t===setTimeout)return setTimeout(e,0);if((t===defaultSetTimout||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){t=defaultSetTimout}try{n="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){n=defaultClearTimeout}}();var s=[],o=!1,l=-1;function cleanUpNextTick(){o&&r&&(o=!1,r.length?s=r.concat(s):l=-1,s.length&&drainQueue())}function drainQueue(){if(!o){var e=runTimeout(cleanUpNextTick);o=!0;for(var t=s.length;t;){for(r=s,s=[];++l<t;)r&&r[l].run();l=-1,t=s.length}r=null,o=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===defaultClearTimeout||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new Item(e,t)),1!==s.length||o||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=noop,i.addListener=noop,i.once=noop,i.off=noop,i.removeListener=noop,i.removeAllListeners=noop,i.emit=noop,i.prependListener=noop,i.prependOnceListener=noop,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function __nccwpck_require__(e){var r=n[e];if(void 0!==r)return r.exports;var i=n[e]={exports:{}},s=!0;try{t[e](i,i.exports,__nccwpck_require__),s=!1}finally{s&&delete n[e]}return i.exports}__nccwpck_require__.ab="//";var r=__nccwpck_require__(229);e.exports=r}()},622:function(e,t,n){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(2265),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,n){var r,s={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,r)&&!a.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:d,props:s,_owner:l.current}}t.Fragment=s,t.jsx=q,t.jsxs=q},7437:function(e,t,n){"use strict";e.exports=n(622)}},function(e){e.O(0,[699,240,842,971,472,744],function(){return e(e.s=6547)}),_N_E=e.O()}]);